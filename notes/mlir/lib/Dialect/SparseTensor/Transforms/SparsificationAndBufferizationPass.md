## SparsificationAndBufferizationPass

A pass that lowers tensor ops to memref ops.
Sparse Tensor ops are lowered through Sparsification and follow-up pass that
lowers sparse_tensor Dialect ops.
Dense Tensor ops are lowered through BufferizableOpInterface implementations.

This pass accept a bunch of options, these options should be pass through
sparse-compiler pass.

Dense tensor are bufferized by `::runDenseBufferization()` method.
This method will filter out all the Tensor with sparse attribute, and do
bufferization for only dense op.

Sparse tensor are lowering(bufferized) through function `::runOnOperation()`.
This function contains three main parts.

### Step 1

Enabling transformations. A new OpPassManager is created to add
PreSparsificationRewritePass, EmptyTensorToAllocTensorPass. Then run the
first pipeline.

* PreSparsificationRewritePass (mlir/lib/Dialect/SparseTensor/Transform/SparseTensorPasses.cpp)

A pass that handles sparse tensor rewriting rules. Like dense tensor to sparse tensor conversion,
sparse tensor reshape...

### Step 2

Vector related pass is enabled when VL is set. Then options.vectorLength will
init the `SparsificationAndBufferizationPass::vectorLength` field. If the field
value is greater than zero, it will add `LoopInvariantCodeMotionPass` and
[`SparseVectorizationPass`](#SparseVectoriazationPass) into `OpPassManager`.

If RuntimeLibrary is not enabled, `SparseTensorCodegenPass`, `SparseBufferRewritePass`
and `StorageSpecifierToLLVMPass` will be added into `OpPassManager`.
If RuntimeLibrary is enabled, then only `SparseTensorConversionPass` will be added
into `OpPassManager`.

And finally the pipeline will be ran.

### Step 3

Bufferize dense ops by `::runDenseBufferization()`

### SparseVectorizationPass

A pass that transform loop that generated by sparse compiler to a form that can exploit SIMD
instructions. See Wikipedia: [Automatic vectorization](https://en.wikipedia.org/wiki/Automatic_vectorization)
for the benefit this pass can give.

Fields:

- Vector Length
- Enable option for [VLA](https://en.wikipedia.org/wiki/Variable-length_array) Vectorization

Enable scalable vector. This option is enabled through `sparse-compiler` pass, by `armsve` option

- Enable option for SIMD Index32

Enable use of 32bit indice in gather/scatter for effiency.

### `vectorizeStmt`

A method to rewrite the given for-loop, with code generation.
If VLA Vectorization is enable, vector scale op will be added into pattern rewriter.
